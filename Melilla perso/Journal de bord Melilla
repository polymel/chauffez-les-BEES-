J1 : Choix du projet - Ã©tablir le Cahier des charges - A qui se destine le projet , pour quelle utilitÃ© , avec quelles contraintes. 

Dans un prmeier temps on dÃ©termine le but global. Le but est de chauffer une riuche afin de faciliter le developpement de l'essaim. On identifie pour qui nous faisons ce projet; cela va faire varier le 
budge et le dÃ©lais. Ce porjet va se dÃ©rouler sur l'annÃ©e scolaire, Ã  raison de 4 heures toutes les deux semaines + travail Ã  l'exterieur si besoin. Le budget est de 50 euros par ruche.

On dÃ©termine les diffÃ©rnets organes nÃ©cessaire : une source d'Ã©nergie (ici un panneau solaire+rÃ©gulateur), une actionneur (ici des resistances qui chauffent,un interrupteur), un automate (ESP32, le comparateur)
et des capteurs (ici les DS18B20, pour mesurer la tempÃ©rature de l'huile). On se sert d'une huile pour stocker l'Ã©nergie. 

Le but final, l'amÃ©lioration est d'utiliser la puissance maximum du systÃ¨me. 




BÃªte Ã  corne 

OUI



J2 : Tester la tension Ã  vide du panneau solaire : besoin d'une fiche (connecteur RCA) , du panneau solaire et le mettre sous le nÃ©on. 
Le jour oÃ¹ il ferra beau faire le montage. 


Utiliser en sÃ©rie un ampÃ¨re mÃ¨tre et en parrallÃ¨le un voltmÃ¨tre. Utiliser une rÃ©sistance "rÃ©glable". 

Utiliser lush pour faire les schÃ©mas 
1. Tester le panneau solaire: on remplace le panneau solaire par un gÃ©nerateur de thevenin 

PremiÃ¨re Ã©bauche de la PCBA :
BOM: 

-ESP32, alimentÃ© en 3,3 V 
-RÃ©gulateur de tension (un seule composant) 
-Groupe comparateur (diode zener pour fixer une tension de seuil , une rÃ©sistance pour mettre une charge Ã  la diode, un comparateur) 
-un interrupteur pilotÃ© par l'ESP32 
- X rÃ©sistances

J'ai ajoutÃ© Ã  l'aide de Simon Git dans VS Code. 


MPN et rÃ©ferences du materiel : 

Je me suis renseignÃ©e egalement sur le process du radiateur Ã  inertie fluide. 

C'est le principe sur lequel on base le chauffage des rÃ©sistances. 

Pour le liquide on peut choisir : De lâ€™eau glycolÃ©e, De lâ€™huile, minÃ©rale ou vÃ©gÃ©tale. 
On appelle ces fluides :fluide caloporteur ou thermo-conducteur


rÃ©sistance, qui transforme le courant en chaleur ;

Est ce que les parois mÃ©talliques des rÃ©sistances conduisent ? comme les bains d'huile 

- : lourd, dur de rÃ©guler Ã  cause du temps de latence 
![alt text](image.png)


Trigger de Shmitt 
Une des application du Trigger de Shmitt est : rÃ©aliser des circuits de contrÃ´le avec hystÃ©rÃ©sis : thermostats, interrupteurs crÃ©pusculaires, maintien du niveau dans une cuve. C'est donc pile ce que l'on veut.


Comment dÃ©finir les seuils infÃ©rieur et superieur ? 
Tension min = tension Ã  partir de la quelle le sytÃ¨me de fonctionnerait ples. 3,3 V? 
Tension max = tension Ã  partir de laquelle la tempÃ©rature est dangereuse pour les abeilles


Quelle est la tempÃ©rature dangereuse pour l'essaim ? 

pas de rÃ©gulateur de Tension sur lush project

HystÃ©rÃ©sis

J3
-------12/11-------

essai 

Le professeur nous donne des articles Ã  lire :

https://www.morningstarcorp.com/faq/what-are-the-different-types-of-solar-charge-controllers/#:~:text=All%20things%20being%20equal%2C%20MPPT,boost%20is%20not%20as%20significant.

https://www.ti.com/lit/ug/tidudj2/tidudj2.pdf?ts=1728344845244&ref_url=https%253A%252F%252Fwww.google.com%252F

https://www.ti.com/lit/an/slyt478/slyt478.pdf?ts=1728361811934

https://www.st.com/en/power-management/mppt-dc-dc-converters.html



Il nous donne aussi un INA 219. il nous permet de mesurer la tension et l'intensitÃ©. Il dessine de montage : un premier montage pour de test pour faire les mesures T/I avec l'INA 219 
et un autre "final" oÃ¹ l'INA sera intÃ©grÃ© dans la carte 

*voir photo  "Montage avec INA 219 et final"*

Le capteur INA219 est un capteur de courant et de tension qui permet de mesurer la puissance Ã©lectrique Ã©changÃ©e entre des appareils. Il communique avec l'Arduino via une interface I2C 
et est adaptÃ© Ã  la mesure de la puissance dans une chaÃ®ne de puissance.


je m'occupe de la partie code du : 


18B20 : Capteurs de tempÃ©rature

et de comment obtenir le fonctionnement du systÃ¨me Ã n p arti d'une certaine tension (3,3 V ? tension de fonctionnement de l'esp) .
ce montage sera composÃ© d'une diode zener , un comparateur et un abaisseur de tension ).


Je veux tester l'iDE arduino que j'ai tÃ©lÃ©charger. Le televersement ne fonctionne pas. Mon ordi ne reconnait pas la carte. 
J'ai dÃ©sinstaller et retÃ©lÃ©charger l'ide. Telecharger d'autres drivers mais cela ne fonctionne pas. 


DifficultÃ©s rencontrÃ©es


TÃ©lÃ©versement du code sur lâ€™ESP32 :

ProblÃ¨me avec l'installation des pilotes.
VÃ©rifier si la carte ESP32 est bien sÃ©lectionnÃ©e dans lâ€™IDE Arduino et si les paramÃ¨tres de port sÃ©rie sont corrects.
Utiliser un code basique pour tester la communication avec la carte.

25/11


Objectif du jour :

RÃ©soudre le problÃ¨me de tÃ©lÃ©versement sur lâ€™ESP32.
Tester et coder la gestion des capteurs DS18B20 pour lire la tempÃ©rature.


Je m'informe sur le capteur : 


On peut mettre plusieurs capteurs en sÃ©rie : 


Chaque capteur de tempÃ©rature DS18B20 possÃ¨de un code sÃ©rie 64 bits unique. Cela vous permet de cÃ¢bler plusieurs capteurs au mÃªme cÃ¢ble de donnÃ©es.
Ainsi, vous pouvez obtenir la tempÃ©rature de plusieurs capteurs en utilisant une seule broche numÃ©rique Arduino.


source : 
https://www.raspberryme.com/guide-du-capteur-de-temperature-ds18b20-avec-arduino/


COmment brancher l'esp32 au capteur de tempÃ©rature ? 

Le capteur de temlpÃ©arature Ã  2 pins

A quoi les brancher ? 


---- changement d'objectif du jour --> il faut commencer la fabrication du PCB donc il faut trouver commetn relier le panneau solaire  Ã  l'esp32 . 

comment alimenter l'esp32 avec l'enregie du panneau solaire ? 


 en Parlant avec Simon : 


SchÃ©ma fonctionnel


EntrÃ©e : Le panneau solaire fournit une tension variable (par exemple, entre 12V et 18V).
Diode Zener et comparateur : VÃ©rifient si la tension est suffisante pour alimenter le systÃ¨me.
Abaisseur de tension (buck converter) : RÃ©gule la tension Ã  3.3V pour alimenter lâ€™ESP32.


Commment choisir les composants ? 




DIODE ZENER 
CHoix de la tension de la diode zener 6,8 V: on reagrde sur le diagramme P_Panneau_Solaire Ã  partir de quelle tension le panneau solaire fonctionne Ã  "pleine puissance". 

On observe que peut importe l'Ã©clairage, le panneau commence Ã  fonctionner autour de 10V. On doit choisir une tesnion en fonction de : 


on choisit une tension parmi les tensions standards des diodes : Diode zener valeurs standards . 

on dÃ©termine la valeur des composants entre le panneau solaire et l'esp32. 

Je me demandais pourquoi on choisissait 6,8 V alors qu'il y a des valeurs standards des diodes zener plus proche de 10v. 
Sauf que R2 va faire chuter la tension donc si on choissit une Zner avec une tension > 6,8 V , il est possible que le sytÃ¨me ne 
sa'ctive pas Ã  partir de 10v reÃ§u dans le panneau solaire. La rÃ©sistance aura fait chuter la tension de 10V. 

R2 : on fait une KVL pour dÃ©tÃ©rminer la valeur de la rÃ©sistance qui se situe entre la panneau solaire et la diode Zener . 

KVL : panneau solaire equivalent Ã  la generateur de tension avec 10V< tension <24V. + Ur2 (tension au borne de R2) + diode zener 
parfaite equivalent generateur de tension de 6,8 V. 


R2 = (tension max du panneau solaire - tension de la zener ) / cournant de R2. 

pour dÃ©terminer cournat de R2 IR2 : 

on doit avoir IR2 compris entre le cournat minimum de la zener et courant maximum  de la zener. Ces courants peuvent Ãªtre trouvÃ©s dans
la doc de la zener. 

Mais oÃ¹ parmis cette intervalle le Ir2 doit Ãªtre ? 

dÃ©ja Ã  quoi correspondent les bornes ? 


Izener min = courant minimal pour que la diode Zener fonctionne correctement en mode Zener , si Ir2 trop proche de Izener min la diode ne maintiendra pas la tension de claquage et la rÃ©gulation Ã©chouera.
Izener max = courant maximal que la diode Zener peut supporter sans surchauffe ou destruction.

il faut que pour la tension max du panneau solaire (26 V), le courant dans la diode (= Ir2 = IdiodeZ) doit Ãªtre  inferieur Ã  Izener max, sinon la diode claque.
il faut que pour la tension min de panneau solaire (10v), le cournat dans la diodde doit Ãªtre superieur Ã  Izener min, sinon la diode ne fonctionne pas. 

Il faut que Ir2 soit le plus proche possible de Izmin afin de ne pas faire chauffer la diode et ne pas l'user prÃ©maturemment. 

Ã  partir de la doc de la znzer et des valeurs Izener min et Izener max on fait l'application numÃ©rique pour R2 :

J'ai du mal Ã  lire la doc : je ne trouve pas de Iz min et Izmax Ã  proprment parler. Il y a  Zerner Voltage Range mais il n' y a qu'une valeur de I
, il y a Maximum Zener Impedance et il y a Maximum Reverse Current mais je n

on lit dans la doc Izener min = 2mA. On voit sur le ghraphique que la zone du coude se termine Ã  2mA. 
voir shÃ©mas graphique dÃ©termination Izmin. 

Pour Ãªtre sur d'avoir passer la zone du coude et parce que la fabrication des composants est variable on prends Ir2 = 5mA. 

Determination de R2 pour Vps max/min avec Ir2 = 5ma :


Pour U panneau solaire = min = 10v et pour Ir2 = 5ma on a R2 = (10-6,8)/5*10^3 donc R2 = 640 omh. N'existe pas . 


POur la tension max dans le panneau ,quelle courant on aurait avce R2 = 640 ohm ? est ce qu'il serait < Ã  Iz max ? 

Iz pour u max panneau solaire = (26-6,8)/640= 0,03 A --> 30 mA<Iz max OK. 

820 ohm --> 24 mA Ã  26 V ; ne dÃ©passe pas Izmax/2 pour la puissance max dissipÃ©e, on chosit cette valeur car elle existe dans les valeurs standards des 
rÃ©sistance et quelle est prÃ©cautiuonneuse (loin du max). 


pour Izamx on lit dans la doc que la puissance max dissipÃ©e = 350 mW donc on fait 350/6,8 = 50 mA. 
donc IzMax = 50mA. 

voir "SchÃ©mas alimentation de l'esp32 au panneau solaire"



COMPARATEUR DE PHASE 

Le comparateur active l'abaisseur de tension Si la tension du panneau est supÃ©rieure au seuil. 


26/11

Objectif d'aujourd'hui : 

Finir le dimensionnementet choix des composants ( resistances du pdt, AOP et sa rÃ©sitance, et regulateur de tension)

j'ai rÃ©cupÃ©rÃ© la resistance grÃ¢ce Ã  "valeur  R2". 

RÃ©sistances du PDT : 

V- de l'AOP est fixÃ© Ã  Vdiode zener = 6,8v. 
Lorsque V+ > Vdiode zener on a Vsortie AOP = + Vcc

On fixe une des deux rÃ©sistances du PDT : 

on veut 6,8 v au borne de R4 avec Vpanneausolaire = 10v pour que au minmium on est bien la sortie de l'AOP qui alimente 
le regulateur ( puis le reste de circuit ).


je fais le schÃ©mas du R2 + PDV + diode + resistance de la Diode 

je n'arrive pas Ã  connEceter le fils sur les noeuds; il y a des noeuds fixÃ©s sur les fils il faut relier les composants sur ses noeuds.

M. Peter m' a fait changer un AOP pour un comparateur. 

La simulation Lush fonctionne : je fixe R4 Ã  1000 ohm. Tandis que je fais varier R3 pour finir par avoir 6,8 aux bornes de R4. 
 donc R3 = 470 ohm et R4 = 1000 ohm.
voir DÃ©trermination R3 et R4 sans valeurs standards des rÃ©sistances.png

on remet un AOP car on se sait pas comment fonctionne le comparateur. 

On ajoute dans la simulation un condensateur (+ resistance sinon la simulation ne fonctionne pas)  qui fonctionnera avec le panneau solaire. 

On multiplie par 10 la valeur des resistances R3 et R4 du PDT afin de reduire la conso d'energie.

resultat de simulation avce R3 = 4700 ohm et R4 = 10000 ohm

On rajoute une rÃ©siatnce en V+ et la sortie --> Ã  quoi cela peut servir ? 


Prochaine fois : 
rajouter une resistance en sortie de l'AOP et et trouver les mpn de l'AOP et du regulateur 

09/12

Le MPN de l'AOP a Ã©tÃ© donnÃ© par le prof. AP331A.



Resistance AOP 

La resistance de l'AOP permet de neutraliser la chute de tension engendrÃ©e par la fermeture de l'interrupteur 
lors de la bascule de 0 Ã  V+. 


La target est d'avoir la resistance la plus petite possible. Cependant  il faut diminuer la valeur de la resistance
jusqu'Ã  la limite de bascule de l'AOP. 

on cherche Ã  avoir la plus petite valeur de R AOP afin d'avoir le delta de tension plus Ã©levÃ©e que la chute de tension.

voir SImulation pour dÃ©termination de RAOP. 

On utilise le principe du trigger de Shmitt, voir "Target de Shmitt".

La "Target de Schmitt" consiste Ã  optimiser les seuils d'hystÃ©rÃ©sis et la rÃ©sistance AOP pour que :

La bascule soit stable et fiable.
Le delta de tension soit suffisamment grand pour compenser les chutes de tension induites par les charges connectÃ©es.

Essai de differentes valeurs pour R AOP :

1 K pas de bascule 
10 K pas de bascule
11 K pas de bascule
12 K pas de bascule
13 K bascule
15 K bascule


La bascule se fait Ã  partir de 13K mais la valeur normalisÃ©e la plus proche et au dessus de 13k et 15K.

R AOP = 15k ohm.



Quel regulateur de tension doit Ãªtre utilisÃ© ? 

est ce que le MPN est imposÃ© ? Simon a dÃ©jÃ  trouvÃ© 


------------------PARTIE PROGRAMMATION----------------


Place Ã  la deuxiÃ¨me partie de mon travail : repondre au besoin de lecture de tempÃ©rature Ã  l'aide du BUS des capteurs. 

ESP32           DS18B20 (x5)
------          -----------
3.3V   ------>  VDD (tous en parallÃ¨le)
GND    ------>  GND (tous en parallÃ¨le)
GPIO4  ------>  DATA (tous en parallÃ¨le)
          4.7 kÎ© entre DATA et 3.3V resitance de pull-up.

Les capteurs DS18B20, comme d'autres dispositifs utilisant le protocole OneWire, partagent une seule ligne de donnÃ©es pour communiquer. Cette ligne est utilisÃ©e pour transmettre des donnÃ©es entre les capteurs et le microcontrÃ´leur (dans ce cas, l'ESP32).

Comportement de la ligne de donnÃ©es :
Lorsque le capteur ou le microcontrÃ´leur ne communique pas, la ligne doit Ãªtre maintenue Ã  un niveau haut (logique "1").
Lorsque le capteur envoie des donnÃ©es, il abaisse volontairement la ligne de donnÃ©es Ã  un niveau bas (logique "0") pendant un court instant.
ProblÃ¨me sans pull-up :
Si la ligne de donnÃ©es n'est pas maintenue Ã  un niveau haut lorsque le capteur n'est pas actif, la ligne pourrait "flotter", c'est-Ã -dire qu'elle pourrait prendre une valeur indÃ©terminÃ©e, ce qui entraÃ®ne des comportements erratiques ou des erreurs de communication.
Fonction de la rÃ©sistance pull-up :
La rÃ©sistance pull-up relie la ligne de donnÃ©es Ã  l'alimentation (gÃ©nÃ©ralement 3.3V ou 5V), assurant ainsi que la ligne soit au niveau haut (logique "1") lorsqu'aucun capteur n'envoie de signal.
Comment Ã§a fonctionne dans le cas du DS18B20 ?
Lorsque le DS18B20 n'envoie pas de donnÃ©es, il laisse la ligne Ã  haut (logique "1"), ce qui est rendu possible grÃ¢ce Ã  la rÃ©sistance pull-up.
Lorsque le DS18B20 veut envoyer un bit Ã  0, il tire la ligne de donnÃ©es vers le bas (logique "0").
Lorsque le DS18B20 veut envoyer un bit Ã  1, il laisse la ligne de donnÃ©es Ã  haut, et la rÃ©sistance pull-up assure que la ligne reste dans cet Ã©tat.
Valeur typique de la rÃ©sistance pull-up :
La valeur standard pour cette rÃ©sistance est souvent 4.7 kÎ©, bien que des valeurs comme 10 kÎ© puissent Ã©galement fonctionner dans certains cas.

Les bibliothÃ¨ques Ã  utiliser sont les : 


Pour connecter 5 capteurs de tempÃ©rature DS18B20 Ã  un ESP32 et enregistrer leurs tempÃ©ratures avant de les transmettre, voici les Ã©tapes dÃ©taillÃ©es :

MatÃ©riel nÃ©cessaire
1 x ESP32.
5 x DS18B20.
1 x rÃ©sistance de 4.7 kÎ© (pull-up).
Breadboard et cÃ¢bles de connexion.
CÃ¢blage
Les DS18B20 fonctionnent sur le principe d'une liaison en bus unique (OneWire), ce qui signifie que tous les capteurs partagent la mÃªme ligne de donnÃ©es. Voici comment les connecter :

Ã‰tapes :
Alimentation :

Relie les broches VDD de tous les DS18B20 Ã  la broche 3.3V de lâ€™ESP32.
Relie toutes les broches GND des DS18B20 au GND de lâ€™ESP32.
Ligne de donnÃ©es :

Relie toutes les broches DATA des DS18B20 ensemble.
Connecte cette ligne DATA Ã  une broche GPIO de lâ€™ESP32 (par exemple, GPIO4).
RÃ©sistance pull-up :

Place une rÃ©sistance de 4.7 kÎ© entre la ligne DATA et 3.3V.
SchÃ©ma de cÃ¢blage
plaintext
Copier le code
ESP32           DS18B20 (x5)
------          -----------
3.3V   ------>  VDD (tous en parallÃ¨le)
GND    ------>  GND (tous en parallÃ¨le)
GPIO4  ------>  DATA (tous en parallÃ¨le)
          4.7 kÎ© entre DATA et 3.3V
Programmation
L'ESP32 devra gÃ©rer plusieurs capteurs sur une mÃªme ligne OneWire. Chaque capteur possÃ¨de une adresse unique (ROM) qui permet de les identifier individuellement.

BibliothÃ¨ques nÃ©cessaires :
OneWire.
DallasTemperature.

je fais des test avec la plaquette ,  2 capteurs, la resistance de pull-up et l'esp32. 

L'ordinateur sert d'alimentation avec l'usb. 

je n'arrive pas Ã  televrerser dans la carte. je colle les codes erreurs dans chat GPT pour essayer de debugger. 

voir image "Montage tÃ©lÃ©versement"

Prochaine sÃ©ance : arriver Ã  tÃ©leverser le programme


07/01 


Bonne annÃ©e !! 

TO do du jour : 

- TÃ©leverser le programme
#include <OneWire.h>
#include <DallasTemperature.h>

// Configuration des broches
#define ONE_WIRE_BUS 4 // GPIO4 pour DATA

// Initialisation du bus OneWire
OneWire oneWire(ONE_WIRE_BUS);

// Initialisation de la bibliothÃ¨que DallasTemperature
DallasTemperature sensors(&oneWire);

void setup() {
  Serial.begin(115200);
  sensors.begin();

  Serial.println("Recherche de capteurs...");
  int numberOfDevices = sensors.getDeviceCount();
  Serial.print("Nombre de capteurs dÃ©tectÃ©s : ");
  Serial.println(numberOfDevices);

  if (numberOfDevices == 0) {
    Serial.println("Aucun capteur dÃ©tectÃ©. VÃ©rifiez le cÃ¢blage.");
  }
}

void loop() {
  sensors.requestTemperatures(); // Demande des tempÃ©ratures Ã  tous les capteurs
  Serial.print("TempÃ©rature capteur 1 : ");
  Serial.println(sensors.getTempCByIndex(0)); // Lecture du premier capteur
  Serial.print("TempÃ©rature capteur 2 : ");
  Serial.println(sensors.getTempCByIndex(1)); // Lecture du deuxiÃ¨me capteur

  delay(1000); // Pause d'une seconde entre les lectures
}
Parameterage de l ide

Ouvrez l'IDE Arduino.

Allez dans Fichier â†’ PrÃ©fÃ©rences.

Dans le champ URL de gestionnaire de cartes supplÃ©mentaires, ajoutez l'URL suivante :

bash
Copier le code
https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_index.json
Astuce : Si une URL est dÃ©jÃ  prÃ©sente, sÃ©parez-les par une virgule.

Ensuite, allez dans Outils â†’ Gestionnaire de cartes.

Recherchez "ESP32" et installez le package officiel de Espressif Systems.

2. Choisir la bonne carte
Pour votre carte spÃ©cifique "WiFi LoRa 32 (V3)" :

Allez dans Outils â†’ Type de carte â†’ ESP32 Arduino.
Recherchez et sÃ©lectionnez la carte "ESP32 Dev Module".
--> ne fonctionne pas 


modif : 

 Outils â†’ Type de carte
ESP32S3 Dev Module


TÃ©lÃ©versement rÃ©ussi : Les Ã©tapes de compression, d'Ã©criture, et de vÃ©rification des donnÃ©es se sont dÃ©roulÃ©es sans erreur.
Chip dÃ©tectÃ© : ESP32-S3 (QFN56) avec 8MB de flash intÃ©grÃ©.
Baud rate : La communication a utilisÃ© un dÃ©bit efficace de 921600 baud.
Hard resetting via RTS pin : Le microcontrÃ´leur a redÃ©marrÃ© automatiquement aprÃ¨s le tÃ©lÃ©versement.


Je veux maintenant tester le programme :


Je configure le moniteur SÃ©rie. 


J'ai maintenant ce message :


TempÃ©rature capteur 2 : -127.00
TempÃ©rature capteur 1 : -127.00



Le message indiquant TempÃ©rature capteur 1 : -127.00 signifie que le microcontrÃ´leur (ESP32) n'arrive pas Ã  lire correctement les capteurs DS18B20.


1 . j'ai vÃ©rifiÃ© les branchement en re regardant les pins map de l'esp32 et du capteur : 
Le GPIO n'Ã©tait pas le bon #define ONE_WIRE_BUS 7 // GPIO7 pour DATA j'ai changÃ© le "4" pour "7" car le cÃ¢blage Ã©taot sur le 7 !!! 

Cela ne fonctionne toujours pas , puis aprÃ¨s enfoncage des composants/cÃ¢ble cela fonctionne ! 


Le capteur 1 dÃ©tÃ©cte 19 degrÃ¨s tandis que le 2 - 127 car il n'est toujours pas branchÃ©. 


Mon thermomÃ¨tre affiche quant Ã  lui il affiche 16 degrÃ¨s. 

La mesure est surement faussÃ©e car les capteurs ont Ã©tÃ© manipulÃ©s. 

Il faut donc prendre en compte cela : les prises de tempÃ©ratures sont sensibles aux manipulations. 

J'attends de voir si la mesure tend Ã  la valeur de celle du thermomÃªtre. 

Cela met en avant l'importance de la mÃ©trologie et de la tolÃ©rance des appareils : un degrÃ¨s de trop pourrait tuer les abeilles. 

Par principe de suretÃ© je conseille de mettre un sueil max qui est d'au moins un degrÃ¨s de moins que la tempÃ©rature max supportÃ©e par l'essaim. 

j'aiDE Laura a tÃ©ste son code car il "ne focntionne pas sur son ordinateur". 

il faut cÃ¢bler l'ina aux montage dÃ©jÃ  existant  :


je suis la doc pour la cÃ¢blage : 


j'utilise une led pour mesurer la tension et le cournant. 


25/02/2025 -

Besoin de faire un point avec l'equipe 

Fait : 
routage PCB
commande du PCB --> arrivÃ©  27/02

dÃ©finition des composants 
code capteur de tempÃ©rature 
code complet lecture temperature - lecture courant tension 
Schemas electronique 

Reste Ã  faire : 

verifier commande des composants OK
finaliser code complet lecture temperature - lecture courant tension 
appro. huile 
vÃ©rification code  lecture courant/tension --> adaptation  mppt avec methode PWM
Montage des composants 
dÃ©finir un plan de test PCBA 

aprÃ¨s verifi PCBA : 
definir contenant huile OK 
essayer sur la ruche 

idÃ©es : 

export de donnÃ©es pour exploitation 

trou dans la raquette :

workshop mppt : essai plusieurs puissances source de lumiÃ¨re , rester au point 


28/02/2025

objectif du jour :
comprendre les notions mppt et Mpp

article 3 : https://www.ti.com/lit/an/slyt478/slyt478.pdf?ts=1728361811934

Une caractÃ©ristique des panneaux solaires est que leur tension de sortie diminue Ã  mesure que le courant prÃ©levÃ© augmente. 


MÃ©thode des 2 points : pour fonctionner Ã  90 % du MPP consiste Ã  activer la charge au Point 1 et la dÃ©sactiver au Point 2
Lorsque la charge est activÃ©e, elle consomme de la puissance, ce qui fait baisser la tension du panneau. Cela dÃ©place le point de fonctionnement du Point 1, en passant par le MPP, jusquâ€™au Point 2. Ã€ ce point, la charge est dÃ©sactivÃ©e, ce qui permet Ã  la tension du panneau de remonter.*

dÃ©fis de la mÃ©thode des 2 points : 

- Adaptation de la tension : la charge (ici les rÃ©sistances chauffantes) et le panneau solaire ne sont pas Ã©gales. ==> besoin de  convertir la tension
-  Gestion des variations rapide la tension du panneau 
- Ajouter un superviseur de tension dâ€™alimentation pour activer ou de dÃ©sactiver lâ€™alimentation Ã©lectrique en fonction de la tension du panneau solaire 



interruption : j'aide Laura a tÃ©ste son code. je debug 






10/03/25

A faire aujourd'hui : 

- Assembler les PCBAs
- dÃ©finir une spec de test 
- COnclure l'inclusion du MPPT PWM dans la programmation 


Je reviens sur la mÃ©thode des 2 points : 

pour mettre en place cette mÃ©thode on a besoin du TPS62125 un rÃ©gulateur de tension cependat nous avons utiliser le 

est ce que le regulateur que l'on a choisit a les mÃªmes caractÃ©ristiques que celui proposÃ© dans l'article ? 
Comment trouver les 2 points ? 

On doit dÃ©terminer une formule dynamique qui calcule P1 et P2. P& et P2 doivent Ãªtre dÃ©termioner de maniÃ¨re dynamique puisque 
l'ensoleillment varie. 

Est ce qu'on a mis les composnats autour ? 

Alors notre configuration est trÃ¨s diffÃ©rente que celle dans l'article. 
On doit dÃ©terminer Ã  partir du bloc de l'INA 219 les formule P1 et P2. 

Quels sont les paramÃ¨tres de P1 et P2 ? 




SÃ©rigraphie du PCB : on Ã©tale la pÃ¢te Ã  braser sur le pochoir fixÃ© Ã  l'aide de pince sur le PCB. 

voir image sÃ©rigraphie




Changement de technique pour rester au pwm :


faire varier le trapport de cycle en fonction de la variation de la tension/courant


SÃ©rigraphie + montage d'un autre PCB : erreur rencontrÃ©e --> lavage du PCB Ã  l'alcool on refait le lendemain. 


11/03/25

PrÃ©vue aujourd'hui : 

- Code avec la nouvelle mÃ©thode pour garder le pwn 
-Assemblage de le seconde carte 


Principe de la modulation de rapport de cycle : 

La tension varie en fonction de l'ensoleillement et des conditions de fonctionnement du panneau solaire. Si la tension augmente, cela signifie qu'il y a plus de puissance disponible, et vice versa. 
En ajustant le rapport cyclique du PWM en fonction de la tension mesurÃ©e, vous pouvez rÃ©guler la quantitÃ© d'Ã©nergie transmise Ã  la rÃ©sistance chauffante

1. Mesurer la tension et le courant du panneau solaire avec lâ€™INA219. --> code existant 


2 . Calculer la puissance disponible + Ajustement du rapport cyclique du PWM en fonction de cette puissance.
Si beaucoup de puissance est disponible, on augmente le PWM.
Si la puissance diminue, on rÃ©duit le PWM pour ne pas surcharger le panneau.


-----------erreur de montage sur la premiÃ¨re carte on change R1 montÃ©e 4,7k omh avec un 470 omh---------------------

J'utilise chatGPT pour le developpement du code 2.

#include <Wire.h>
#include <Adafruit_INA219.h>

Adafruit_INA219 ina219;

const int pwmPin = 5;      // Broche de sortie du PWM (Ã  connecter Ã  la rÃ©sistance chauffante)
const int pwmChannel = 0;  // Canal PWM utilisÃ© par l'ESP32
const int pwmFreq = 1000;  // FrÃ©quence PWM (1 kHz)
const int pwmResolution = 8; // RÃ©solution en bits (0-255)

void setup() {
    Serial.begin(115200);
    Wire.begin(); // Initialisation du bus I2C

    // VÃ©rifier que l'INA219 fonctionne
    if (!ina219.begin()) {
        Serial.println("Ã‰chec de la connexion Ã  l'INA219 !");
        while (1);
    }
    
    Serial.println("INA219 initialisÃ© !");
    
    // Initialisation du PWM
    ledcSetup(pwmChannel, pwmFreq, pwmResolution);
    ledcAttachPin(pwmPin, pwmChannel);
}

void loop() {
    // Lire la tension et le courant du panneau solaire
    float tension = ina219.getBusVoltage_V();
    float courant = ina219.getCurrent_mA() / 1000.0; // Convertir en A
    float puissance = tension * courant; // Calcul de la puissance (P = U Ã— I)

    // DÃ©finir la valeur du PWM en fonction de la puissance disponible
    int pwmValue = map(puissance, 0, 10, 0, 255); // Adapter selon la plage de puissance rÃ©elle

    // Limiter la valeur du PWM entre 0 et 255
    pwmValue = constrain(pwmValue, 0, 255);

    // Appliquer le PWM Ã  la rÃ©sistance chauffante
    ledcWrite(pwmChannel, pwmValue);

    // Afficher les valeurs sur le moniteur sÃ©rie
    Serial.print("Tension : "); Serial.print(tension); Serial.print(" V, ");
    Serial.print("Courant : "); Serial.print(courant, 3); Serial.print(" A, ");
    Serial.print("Puissance : "); Serial.print(puissance); Serial.print(" W, ");
    Serial.print("PWM : "); Serial.println(pwmValue);

    delay(1000); // Attendre 1 seconde avant la prochaine mesure
}


erreure rencontrÃ©e : C:\Users\melim\Documents\Etude\POLYTECH\4A\S7\Projet Ã©lectronique\32\32.ino: In function 'void setup()':
C:\Users\melim\Documents\Etude\POLYTECH\4A\S7\Projet Ã©lectronique\32\32.ino:10:3: error: 'ledcSetup' was not declared in this scope
C:\Users\melim\Documents\Etude\POLYTECH\4A\S7\Projet Ã©lectronique\32\32.ino:11:3: error: 'ledcAttachPin' was not declared in this scope; did you mean 'ledcAttach'?

exit status 1

Compilation error: 'ledcSetup' was not declared in this scope


je teste un code simple pour vÃ©fier la connxion de mon ESP32 et mon environnement : 
void setup() {
  Serial.begin(115200);  // Initialise la communication sÃ©rie
  delay(1000);  // Pause pour stabiliser
  Serial.println("ESP32 OK");
}

void loop() {
  Serial.println("ESP32 fonctionne !");
  delay(1000);  // Attendre 1 seconde
}


--- en parrallÃ¨le on remonte le PCBA + on le met au four --- 

Utilisation du four : cycle Ã  vide + cycle "C3 pour cuire la PCBA


* photo four **
PrÃ©caution : chaleur importante et pas de moyen de protection 
On inspecte la carte visuellement => * image inpestion * 
explication installation broche pour tÃ©lÃ©verser : 

RX	RÃ©ception (UART)	Lire des donnÃ©es dâ€™un PC, capteur sÃ©rie
TX	Transmission (UART)	Envoyer des donnÃ©es Ã  un PC, autre microcontrÃ´leur
GND	Masse	Connexion de rÃ©fÃ©rence pour tous les composants
RST	Reset	RedÃ©marrer lâ€™ESP32
3.3V	Alimentation	Alimenter des modules (capteurs, Ã©crans, etc.)


-- Brasage manuel des caPteur ==> difficultÃ©s rencontrÃ©es : ponts entre les pins, peut Ãªtre du Ã  la taille de la tige. 

24/03 

Ordre du jour : 

1. reprise des composants brasÃ©s manuellement 
2. mesures des caractÃ©ristiques du panneau solaire Ã  l'aide du rÃ©austat


2.1 Montage thÃ©orique 

Materiel nÃ©cessaire : 

- RÃ©austat 
-2 multimÃªtres 
-panneau solaire 
- fiches bananes 
- LumiÃ¨re variable 
- Autotransfo 



Determination du schÃ©mas : 

voir photo Montage mesure caractÃ©ristique panneau solaire .jpg

point de vigilance : comment monter les multimÃªtres ? 

-> le voltmÃªtre se branche en parrallÃ¨le Ã  la charge : Le voltmÃ¨tre mesure la diffÃ©rence de potentiel Ã©lectrique entre deux points d'un circuit.
La tension est la diffÃ©rence de potentiel entre deux points, donc pour mesurer cette diffÃ©rence, il doit Ãªtre connectÃ© en parallÃ¨le aux deux points oÃ¹ la tension est Ã  mesurer.

voir photo choix montage ampÃ¨rmetre 
-> L'ampÃ¨remÃªtre : Un ampÃ¨remÃ¨tre doit toujours Ãªtre connectÃ© en sÃ©rie avec le circuit dont tu veux mesurer le courant, car il doit permettre au courant de passer Ã  travers lui.
On peut soit mettre l'ampÃ¨remetre dans le branchment du voltmÃªtre soit en dehors. 

Cela dÃ©pend de l'impÃ©dance caractÃ©ristique du multimÃªtre.  le multi peut Ãªtre numÃ©rique ou Ã  aiguille. 
Dans le premier cas : on a Z proche de 1 mÃ©ga ohm. - photo autotransfo --

Tandis que dans un mÃ©canisme Ã  aiguille on a un bobinage unique avec un curseur qui fait varier le rapport de spear et donc la tension secondaire entre 0 et 230 V. Ce bobinage 
est en sÃ©rie avec une rÃ©sistance et celle ci Ã  une valeur << Ã  1 mega ohm. 

On choisira alors de mettre l'ampÃ¨remÃªtre dans la boucle et oon peut nÃ©gliger ainsi la cournat du voltmÃ¨etre. 



2.2 montage pratique 

Voir image montage physique 


Rq = : le panneau solaire chauffe entre chaque mesure il faut le laisser refroidire. Les panneaux solaire perdent en puissance lorsqu'ils chauffent => les panneaux solaires 
sur les toits ne doivent pas Ãªtre collÃ©s au toit des maison mais devraient laisse circuler l'air. 

Les resultas experimentaux suivent les rÃ©sultats thÃ©oriques attendus. 

On a deux varibales Ã  mesurer : la tension et le courant. 
On a 2 variables Ã  faire varier : le rÃ©austat et l'intensitÃ© lumineuse avec l'auto transformateur. 
On augmente la prise de point entre 20 et 20 ohm car c'est la que ce trouve le pwm  => rectification c'est entre 1200 et 300



rq : on a pas de valeur pour A = 0 


25/03/25 


Retex 24/03 : prise des mesures pour 3 intensitÃ©s lumineuses 

ordre du jour : 


1. reprise des composants brasÃ©s manuellement 
2. continuer mesures des caractÃ©ristiques du panneau solaire Ã  l'aide du rÃ©austat
3.Analyse des mesures 

On re oinstalle le montage 


rq : on est obligÃ© de faire des pauses frÃ©quente car le panneau chauffe 
voir influence de la tempÃ©rature sur les mesures .jpg


besoin de faire l'algo 

on trace ne plus P en fontion de U -> cela nous sera utile dans le but de dÃ©finir les 2 bornes nÃ©cessaires Ã  l'algo mppt


INFO / passage de fournissement de 220 Ã  230 V par EDF car moins d epertes Ã  230 V

on observe que pour des puissances lumineuses comprise entre 260 et 750 W/M^2 on a une puissance compriuse entre 0,02 et 0,2 W tandis aque pour l'
intensitÃ© luminuse max Ã  2000 w/m^2 on a une puissance comprise netre 0,6 et 6 W. 

La puissance du panneau semble faible.

Quelle est l'ordre de grandeur luminuse du soleil en W/m^2 ? 

source chat GPT L'ordre de grandeur de la puissance lumineuse du Soleil est dâ€™environ 1361 W/mÂ² au niveau de la limite de lâ€™atmosphÃ¨re terrestre (c'est la constante solaire).

ğŸ“Œ Sur Terre, aprÃ¨s absorption et diffusion par lâ€™atmosphÃ¨re, lâ€™ensoleillement maximal atteint environ :

1000 W/mÂ² en plein midi, par temps clair et sans obstacle.

200 Ã  500 W/mÂ² par temps nuageux.

0 W/mÂ² la nuit. 
